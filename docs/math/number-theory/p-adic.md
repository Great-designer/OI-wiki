p 进数（p-adic）由 Hensel 于 1900 年前后引进，其想法是把幂级数展开的方法引进到数论中来。

p 进数 $\mathbb{Q}_{p}$ 是有理数 $\mathbb{Q}$ 的完备化，从而 p 进数 $\mathbb{Q}_{p}$ 和实数 $\mathbb{R}$ 属于同一类事物，因为 p 进数像实数一样关于指对数和乘开方不是封闭的。由于复数 $\mathbb{C}$ 是实数 $\mathbb{R}$ 的扩充，关于指对数和乘开方是封闭的，从而 p 进数 $\mathbb{Q}_{p}$ 和复数 $\mathbb{C}$ 不是同一类事物。

## 思想方法

有理数集的基数是 $\aleph_0$，其中有很多的洞，填补这些洞的方法有若干种。通常的填补这些洞的方法创造出实数，实数集的基数是 $\aleph_1$。

一个例子是，令有理数列 3、3.1、3.14、3.141、3.1415、3.14159……收敛，于是创造了一个新数 $\pi$ 当做这个数列的极限点。

要想理解这件事，需要明确什么叫逼近。按通常理解，如果两个数数位上的数码向右数时有很长一段是一致的，那么这两个数就是逼近的。

用类似的技巧来构造 p 进数，不同之处在于选择了一个新的逼近定义。如果两个数数位上的数码向左数时有很长一段是相同的，那么这两个数是逼近的。例如 10 进数 0.002、0.072、0.172、8.172、28.172、828.172、1828.172……变得越来越靠近某个数。

通常的实数，在小数点左边只有有限位数，在小数点右边可能有无限位数。然而，p 进数总是写成小数点右边有有有限位数，小数点左边可能有无限多位数码的形式。通常的 2.71828……不可能是 p 进数，而……1828.172 却可以是一个 p 进数。

### 数环和数域

在上述思想方法中，可以要求 p 是素数。如果 p 不是素数，按照同样的定义方法得到的代数系统只构成环，除法不一定总能进行。

例如，把两个 10 进数相除不总是可行，因为存在两个非 $0$ 的 10 进数满足乘积为 $0$ 的情形，从而只构成数环。

当且仅当 p 为素数时，每个非零的 p 进数都有一个倒数，这时可以对任意两个这样的数做除法。从而，按照上述定义方法得到的代数系统构成域，只要 $0$ 不为除数，除法总是可以进行。

## p 进绝对值

设 $p$ 为一个素数。任一非零有理数 $a$，都可以唯一地写成：

$$
a=p^m\frac{u}{v}
$$

其中 $m$ 是整数，$u$、$v$ 是不被 $p$ 整除的整数。定义有理数 $a$ 的 p 进赋值 $v_p(a)$ 为：

$$
v_p(a)=m
$$

即 $a$ 中含有 $p$ 的个数，可以为 $0$ 或为负。可以理解为 $a$ 恰好被 $p$ 的以 $v_p(a)$ 为指数的幂除尽。

定义有理数 $a$ 的 p 进绝对值 $|a|_p$ 为：

$$
|a|_p=p^{-v_p(a)}=p^{-m}
$$

构成有理数域上的非阿基米德赋值和绝对值。

Ostrowski 证明了定理：

有理数域上完备的绝对值只有两大类：一类是阿基米德绝对值，即通常绝对值，一类是非阿基米德绝对值，即上述 p 进绝对值。

有理数域关于通常绝对值作完备化是实数域，这是通常数学分析做的事情。

有理数域关于 p 进绝对值作完备化得到的数域是 p 进数域。

### 和数论的联系

从数论出发是历史上 p 进数最早被发现的视角，这样的视角不好入手，后来才发现更加容易入手的数学分析的视角。这有些类似于对数比指数更早发现的情形，历史上最早发现对数也是使用了一种在今天看来很不自然的视角。

如同上述绝对值的定义，p 进数与实数有着不同的远近感，p 进数的远近感是“来自于同余式”的远近感。

例如二进制数 110110 和 101110。

如果模 8，相当于取这两个数的最后三位，结果都为 110。这也就是说，模 8 意义下无法区分两个数。

而模 16 的时候，相当于取这两个数的最后四位，分别为 0110 和 1110。这个时候才能区分开两个数。

因此有这种感觉，模 4 就能区分的两个数，比模 16 才能区分的两个数，在 2 进数意义下距离更远。

p 进数重新定义了两个数的距离。如果模 $p^a$ 才能够区分两个数，那么这两个数的距离就是 $\frac{1}{p^a}$ 次幂，即写成 p 进数表示后从右往左第几位才开始不同。

### 序关系

在实数中，如果 $x$ 和 $y$ 是两个不相等的实数，于是要么 $x<y$ 成立，要么 $y<x$ 成立。然而，p 进数表示的数无法像普通实数那样排在一条直线上，即没有通常意义的序关系。

因此，模数为素数幂次时，高幂次模数是对低幂次模数更加细化的划分。这样就理解了 p 进数中更靠左的位数更小，与一般的整数理解恰好相反。

也可以这样理解：多项式除法的时候，既可以使得余式的次数越除越高，也可以使得余式的次数越除越低。这依赖于除法的意义不同，导致除法的方向相反。

由于越靠左的位数表示距离越近，权重越小，因此 p 进数下的数左边可以无限长，但右边一定有限长，即小数点后的位数有限。

从而，p 进数的几何直观与实数不同。实数的几何直观是一条连续的线，而 p 进数的几何直观是一棵向两端无限延展的有序 p 叉树。除了 $0$ 不是节点以外，每个节点均有一个层高，有 p 个子代节点（向最右端补上 $0$ 到 $p-1$）和一个亲代节点（去掉最右端，即使最右端可能是 $0$），并且子代比亲代更大。仅当最右端不是 $0$ 的节点表示一个 p 进数。

仅当祖先节点和子孙节点之间存在偏序关系，其余位置不存在偏序关系。两个节点的层高可以不同，但是层高不同不一定存在偏序关系。

例如，在 $5$ 进数中，$1$ 和 $4$ 的层高相同，因此它们不存在大小关系。

### 四则运算

p 进数的四则运算加减乘除与实数小数的操作方法是类似的。例如两个小数相加，就是逐位相加，超过 p 向高位进位。

加法和乘法与普通的实数运算完全一致。减法和除法等价于加上相反数以及乘上倒数。

## 有理数的 p 进展开方法

对不同的有理数，p 进展开之后有不同的形式。由于 p 进数仍旧满足加减法和乘法，相应内容可以简单推理。

### 正整数的 p 进展开

对于正整数 $a$，它的 p 进展开就是它在实数中的 p 进制表示，二者完全相同。

由于正整数对于加法和乘法封闭，从而 p 进数中的正整数的加法与乘法，与实数中的 p 进制表示的整数的加法与乘法完全一致，超过 p 向高位进位。

### 负整数的 p 进展开

在 p 进数中，没必要为负数标记一个负号，相反数可以直接写出。

对于正整数 $a$，对应的相反数负整数 $-a$ 的办法是：最右边的非零位用 $p$ 减，左边所有的位均用 $p-1$ 减。

例如 $5$ 进数中 $\cdots 1240$ 的相反数是 $\cdots 444443210$，可以记为循环小数 $\dot{4}3210$。从而，所有的负整数具有循环小数的特征，一个整数从某位起，左端均为 $p-1$。

特别地，左端每位均为 $p-1$ 的循环小数表示 $-1$。例如 $5$ 进数中 $\dot{4}$ 表示 $-1$。

这与计算机科学中，二进制补码的情形完全相同，二进制补码相当于对一个很大的数 $2^n$ 进行取模。

### 取倒数的办法

只要 p 是素数，对每个 p 进数都可以进行取倒数操作。根据公式：

$$
\frac{1}{1-x}=1+x+x^2+\cdots
$$

从而对于任意一个 p 进有理数 $a$，其倒数为：

$$
\frac{1}{a}=1+(1-a)+{(1-a)}^2+\cdots
$$

这与数论倒数的情形完全相同。可以证明，在 p 进数中，对于任意非零的 $a$，这个取倒数的级数都是收敛的。该级数在通常的实数中，只有 $(0,2)$ 范围内收敛。

对于 $\frac{1}{p^k}$ 的情形，直接使用左右移位的办法，移动小数点。

### 非零有理数的 p 进展开

对于一般的非零有理数 $\alpha=p^{n}\frac{a}{b}$，其中 $a$ 和 $b$ 均不被 $p$ 整除。

由于式中 $p^{n}$ 是最后一步，即移动小数点，记式中另一部分 $\frac{a}{b}$ 的整数部分和小数部分：

$$
\frac{a}{b}=\left[\frac{a}{b}\right]+\left\{\frac{a}{b}\right\}
$$

整数部分已经知道如何进行 p 进展开，只需考虑小数部分 $\left\{\frac{a}{b}\right\}$。可以记：

$$
\left\{\frac{a}{b}\right\}=\frac{c}{b}
$$

其中 $c<b$。由于 $b$ 和 $p$ 互素，存在正整数 $s$，使得 $p^s\equiv 1 \pmod b$。

记 $p^s-1=bm$，从而有：

$$
\frac{c}{b}=\frac{cm}{p^s-1}=-\frac{cm}{1-p^s}
$$

因为 $c<b$，所以 $cm<p^{s-1}$，于是 $cm$ 可以进行 p 进展开，乘上分母构成的幂级数之后，构成一个循环节长度为 $s$ 的循环小数。

循环小数相加仍旧是循环小数，移位也仍旧是循环小数。从而证明了定理：

一个 p 进数是有理数，当且仅当它的小数点左边的数位上的数码向左无限循环。

在实数中有对应的定理：在实数中一个数是有理数，当且仅当它的小数点右边的数位上的数码向右无限循环。

### 数论的观点

在上述整数的除法中，也可以要求从右往左除，完成 p 进数的计算。

因为有取模的意义，采用 p 进数的时候，有理数本身和它的表示一定是一一对应的，而不是像普通的 p 进制实数存在一二对应。

例如 7 进制下，0.6666666……和 1 表示同一个数，即每个有限小数都是一二对应，存在两种表示方法，而 7 进赋值下……6666666.0 和 1 表示不同的数。在有理数范畴，实际的数与它的表示永远是一一对应的。

上面例子的……6666666.0 事实上表示 - 1，在 p 进数里没有负号。

也可以用数论倒数的观点看待有理数的 p 进数表示。

例如模 13 意义下，无法区分 $\frac{1}{3}$ 和 $9$，那么有理数 $\frac{1}{3}$ 在 13 进数里最后一位就是 $9$，并且是小数点前一位。如果想知道有理数 $\frac{1}{3}$ 在 13 进数里倒数第二位是多少，就需要求解模 169 的时候 3 的倒数是多少，以此类推。

这两种解释完全等价。

采用 p 进数的时候，小数点后不为 0 的情况（合法 p 进数必然有限长），就是有理数分母中存在 p 的情况。例如 $0.1$ 表示 $\frac{1}{p}$。左边无限循环的情况，就是分母中存在非 p 素因子的情况，也有可能代表负数。

采用 p 进数方法记录的数，加减乘除的规则都与普通的整数完全相同，只是除法方向相反而已。

因此可以找一个计数方法巧妙记录有理数，例如将 $\frac{1}{3}$ 记录成……10101010101 等等，在数论方面的性质仍旧保留了。

## 完备化方法

根据上述讨论，可以给出两种等价的定义。

定义 1：p 进数域定义为有理数域关于 p 进绝对值作完备化得到的数域。

p 进数域的一个元素是柯西列的等价类。

柯西列是指有理数列 $x_n$ 满足：对任意的 $\varepsilon>0$，存在正整数 $N$，使得任意的 $m,n\geq N$ 有 $|x_m-x_n|_p<\varepsilon$。

称两个柯西列 $x_n$、$y_n$ 是等价的，当且仅当 $\lim_{n\to \infty} |x_{n}-y_{n}|_{p}=0$。

这些柯西列的等价类关于自然的加法和乘法运算成为一个域，叫做 p 进数域。从而，有理数域上的 p 进绝对值可以自然延拓到 p 进数域上去。

定义 2：p 进数域定义为：

$$
\mathbb{Q}_{p}=\left\{ \sum_{n=m}^{\infty}c_{n}p^{n} | c_{n}\in \{0,1,\cdots,p-1\} \right\}
$$

称为 p 进展开，类似于实数的十进制展开。

这两种定义是等价的。证明如下：

一方面，设 $\sum_{n=m}^{\infty}c_{n}p^{n}$ 是定义 2 的元素，它对应的柯西列是 $c_{m}p^{m}, c_{m}p^{m}+c_{m+1}p^{m+1}, c_{m}p^{m}+c_{m+1}p^{m+1}+c_{m+2}p^{m+2},\cdots$。

另一方面，设 $x_{n}$ 是有理数柯西列，取整数 $m$ 使得 $v_{p}(x_{n})\geq m$，从而 $p^{-m}(x_{n})\in \mathbb{Z}_{p}$。

存在整数 $0\leq c_{m}\leq p-1$，使得 $v_{p}((x_{n})-p^{m}c_{m})\geq m+1$，以此类推可得展开式 $x_{n}=\sum_{n=m}^{\infty}c_{n}p^{n}$，其中 $0\leq c_{n}\leq p-1$。

定义 2 表明，可以这样看待 p 进数：和每个实数都可以写成一个小数的形式一样，每个 p 进数 $\sum_{n=m}^{\infty}c_{n}p^{n}$ 也可以写成小数的形式：$\cdots,c_{1},c_{0},c_{-1},\cdots,c_{m+1},c_{m}$。

例如 $5$ 进数中，$3\times \frac{1}{5}+4\times 5+2\times 5^{2}+\cdots$ 的小数表示就是 $\cdots 240.3$。

规定，每一个右端有限，左边无限不循环的合法 p 进数定义一个 p 进数意义下的无理数。那么全体合法 p 进数对应全体 p 进数意义下的实数。

数列的收敛：当且仅当随着 p 进数数列不断延伸，p 进数从右往左各位逐一确定（不再改变），则 p 进数数列收敛于一个 p 进数。

数列发散于无穷：当且仅当随着 p 进数数列不断延伸，p 进数的右边位数不断增长，可以增长到任意位数，则 p 进数数列发散于无穷。

其余情况为一般的发散（不收敛）。

定义了收敛和发散，自然所有可以收敛到的值，对应全体 p 进数意义下的实数。也就是说，可以用无穷的 p 进数有理数数列逼近任一个 p 进数实数。

### 对应关系

实数对于开方和对数运算不是封闭的，从而向实数中添加虚数单位 $\mathrm{i}$ 构成复数，复数对于开方和对数运算是封闭的。向实数中添加虚数单位 $\mathrm{i}$、$\mathrm{j}$、$\mathrm{k}$ 构成四元数，四元数牺牲了乘法交换律，仍旧构成一种新的代数系统。

就像复数和四元数之间难以找到元素的对应关系一样，实数和 p 进数是完全不同的数域，两者只有部分元素之间存在对应关系，部分元素之间找不到对应关系。

p 进数意义下的实数与正常的实数不同，往往不存在一一对应关系。一些正常的实数可能不对应于任何 p 进数意义下的实数，一些 p 进数意义下的实数也可能不表示任何正常实数。当然，也不保证两者一多对应的存在，因此事实上 p 进数创造了新的数学分析体系。

## 对数与指数

向 p 进数中引入对数与指数的办法，与离散对数类似。这是因为，指数函数与对数函数构造了加法群和乘法群的同构。

p 进数的指对数计算也是构造这样的同构关系。用 $\mathrm{e}^x$ 和 $\ln x$ 引入，计算时采用展开成无穷级数的方法。

### 展开式定义

根据上文收敛和发散的定义可以证得定理：

在 p 进数中，指数函数

$$
\mathrm{e}^x=1+x+\frac{1}{2}x^2+\frac{1}{3!}x^3+\frac{1}{4!}x^4+\cdots
$$

收敛，等价于：

- p 为奇素数时，$x$ 是 $p$ 的倍数（即 $x$ 是整数且末位为 $0$）。
- p 为 $2$ 时，$x$ 是 $4$ 的倍数（即 $x$ 是整数且末两位为 $00$）。

在 p 进数中，对数函数

$$
\ln x=(x-1)-\frac{1}{2}(x-1)^2+\frac{1}{3}(x-1)^3-\frac{1}{4}(x-1)^4+\cdots
$$

收敛，等价于 $x$ 是整数且末位为 $1$，即 $x-1$ 是 $p$ 的倍数。

证明：容易得到：

$$
v_p \left(\frac{x^n}{n!}\right)=n v_p(x)-v_p(n!)
$$

$$
v_p \left({(-1)}^{n-1}\frac{{(t-1)}^n}{n}\right)=n v_p(t-1)-v_p(n)
$$

由升幂定理和威尔逊定理则容易证得。

### 收敛域

对数与指数存在收敛域问题，很多 p 进数无法计算对数与指数。

这和实数中的结论类似，实数中很多数也无法计算对数与指数。这里需要对比一下实数中的对数与指数运算。

在实数范围内，对数的底数必须在 $(0,1)$ 或者 $(1,+\infty)$。虽然 $1$、$0$ 和负实数可以有整数次幂，但是它们不能作为底数。对数的定义域在 $(0,+\infty)$，值域为全体实数。

在实数范围内，指数的底数在 $(0,+\infty)$，$0$ 和负实数不能作为底数。指数的定义域为全体实数，值域为全体正实数，当底数为 $1$ 时，值域只有 $1$。

可以看到，在对数、指数和乘开方这组三元关系中，在部分点的取值上不是严格的逆运算关系。例如负实数拥有全部的整数次幂，在实数范围内却不能定义以负实数为底的完备的对数与指数运算。

从而，很多正常的实数没办法表示，因为两个无穷级数在 p 进赋值里存在收敛域（收敛域不难计算），一个普通的 x 在正常实数范畴可以存在指对数，到 p 进数里就可能落在收敛域之外。又有可能在正常实数里负数无法计算对数，但是将负数表示为 p 进数之后可能落在收敛域里，就存在对数。

### 定义的根据与意义

上面的定义依赖展开式，即只与多项式本身有关，不依赖于 x 的取值。

只用多项式理论即可证得，这种定义满足乘加转换。对于任意的 a 和 b，满足：

$$
\mathrm{e}^{a+b}=\mathrm{e}^a\mathrm{e}^b
$$

$$
\ln ab=\ln a+\ln b
$$

因此这样定义的指对数函数，在其内部是完备的。

### 加法群和乘法群的同构

同构，即建立互反性，用一个嵌套另一个，会得到 $1$，即两种运算互逆。这样就可以借助公式：

$$
a^b=\mathrm{e}^{b\ln a}
$$

可以定义任意二元幂运算，只要相应变量均落入指对数收敛域即可。同时借助换底公式可以计算任意二元对数，也要求落入收敛域。

有定理：

- p 为奇素数时，令 $m\geq 1$。
- p 为 $2$ 时，令 $m\geq 2$。

则指数和对数给出群的互逆的同构。即，加法群 $p^m\mathbb{Z}_{p}$ 与乘法群 $1+p^m\mathbb{Z}_{p}$ 的同构。

特别地，其中最大的群为

- p 为奇素数时，加法群 $p\mathbb{Z}_{p}$ 与乘法群 $1+p\mathbb{Z}_{p}$ 同构。
- p 为 $2$ 时，加法群 $p^2\mathbb{Z}_{p}$ 与乘法群 $1+p^2\mathbb{Z}_{p}$ 的同构。

证明：对于所有 $n\geq 1$ 容易得到不等式：

$$
\frac{n-1}{p-1}\geq v_p(n!)
$$

于是可以得到，对于 $n\geq 1$ 有结论：

- 对于定义域 $p^m\mathbb{Z}_{p}$，由于 $v_p\left(\frac{x^n}{n!}\right)\geq m$，所以 $\mathrm{e}^x$ 的值域在 $1+p^m\mathbb{Z}_{p}$。
- 对于定义域 $1+p^m\mathbb{Z}_{p}$，由于 $v_p\left({(-1)}^{n-1}\frac{{(t-1)}^n}{n}\right)\geq m$，所以 $\ln t$ 的值域在 $p^m\mathbb{Z}_{p}$。

对这个范围内的 $x$ 和 $t$ 则可以只用多项式理论证得 $\ln(\mathrm{e}^x)=x$ 和 $\mathrm{e}^(\ln t)=t$，证毕。

从而，当 p 为奇素数时，加法群 $p\mathbb{Z}_{p}$ 恰好为指数函数 $e^x$ 的定义域，乘法群 $1+p\mathbb{Z}_{p}$ 恰好为对数函数 $\ln x$ 的定义域，二者构成双射关系，从而该定义是完备的。即，仅当被 p 整除的数可以计算指数，被 p 除余 1 的数可以计算对数。

注意，对于 2 进数则不是这样。虽然加法群 $p^2\mathbb{Z}_{p}$ 恰好为指数函数 $e^x$ 的定义域，但是对数函数 $\ln x$ 的定义域是 $1+2\mathbb{Z}_{p}$，比乘法群 $1+4\mathbb{Z}_{p}$ 要大。

这意味着什么呢？所有奇数均在对数收敛域内。然而，全体被 4 除余 3 的数算出来的对数不满足双射条件，算出的对数值再代入指数无法得到原数，而是它的相反数——被 4 除余 1 的数。这是因为有结论：

在 2 进数中，由级数定义的 $\ln (-1)$ 值为 $0$。

证明：如果硬写成级数形式则不是显然的。首先在 2 进数中级数 $\ln (-1)$ 是收敛的，由上一节仅由级数性质在收敛域内有 $\ln ab=\ln a+\ln b$，则有 $0=\ln 1=\ln (-1\cdot -1)=\ln (-1)+\ln (-1)=2\ln (-1)$。

由于 2 进数构成域，乘除法总是可逆的，从而 $\ln (-1)$ 只能为 $0$，证毕。

从而，在 2 进数中真正满足双射条件的部分，仅当被 4 整除的数可以计算指数，被 4 除余 1 的数可以计算对数。这比奇素数时要严格。

这也就解释了在离散对数部分，更常使用以 5 为底的对数，以 3 为底则不常用。

在这部分里面可以应用换底公式等指对数嵌套的公式。从而，底数必然位于对数函数 $\ln x$ 的定义域，对于 2 进数是 $1+4\mathbb{Z}_{p}$，对于其他 p 进数是 $1+p\mathbb{Z}_{p}$。

这里的指对数与离散对数有何异同？离散对数构建的指对数体系，要求幂次（指数）是普通的整数，只有底数和真数（幂）是取模意义下的。

这里 p 进数理论中的指对数，底数、指数（幂次）和幂（真数）均在 p 进数中。它建立了一个双射：模 p（或 4）余 1 的乘法，与模 p（或 4）余 0 的加法之间的双射。

### 2 进数的示例

可以计算 2 进数下的 $\mathrm{e}^4$ 和 $\ln 5$，进而直观了解指对数：任意指数都是 $\mathrm{e}^4$ 的指数，利用换底公式可以转换成以 5 为底的对数，从而与以 5 为底的对数构成对比。

$\mathrm{e}^4$ 的例子参见：

- [OEIS A320815 Digits of the 2-adic integer exp(4).](http://oeis.org/A320815)
- [OEIS A320814 Approximation of the 2-adic integer exp(4) up to 2^n.](http://oeis.org/A320814)

$\ln 5$ 的例子参见：

- [OEIS A152228 2-adic expansion of log(5).](http://oeis.org/A152228)
- [OEIS A321690 Approximations up to 2^n for the 2-adic integer log(5).](http://oeis.org/A321690)

同样还能找到更多有趣的数列，可以在 OEIS 上搜索“2-adic integer”，例如 $\ln (-3)$ 等等（A321694、A321691）。

注意，无论奇素数或 2 的情形，$\mathrm{e}$ 和 $\ln 2$ 的相应 p 进数表示均无法计算，落在收敛域外，找不到对应的表示。

### 乘法群的结构

仿照离散对数可以刻画缩系乘法群的结构一样，照样可以刻画 p 进数中的乘法群结构。首先给出定理：

- p 为奇素数时，乘法群 $1+p \mathbb{Z}_p$ 与 $\mathbb{Z}_p$ 同构。
- p 为 $2$ 时，乘法群 $1+2 \mathbb{Z}_2$ 为子群 $\{-1,1\}$ 与子群 $1+4 \mathbb{Z}_2$ 的直积，而 $1+4 \mathbb{Z}_2$ 同构于 $4 \mathbb{Z}_2$。

这与离散对数中的结论完全一致。

证明：

- 对于奇素数的情形，按照指对数的双射性，有乘法群 $1+p \mathbb{Z}_p$ 同构于 $p \mathbb{Z}_p$，定理显然。
- 对于 p 为 $2$ 的情形，按照指对数的双射性，有乘法群 $1+4 \mathbb{Z}_p$ 同构于 $4 \mathbb{Z}_p$，定理显然。证毕。

根据科学记数法和费马欧拉定理，可以证得定理：

- p 为奇素数时，乘法群 $\mathbb{Q}_p$ 同构于 $\mathbb{Z}$、$\frac{\mathbb{Z}}{(p-1)\mathbb{Z}}$ 和 $\mathbb{Z}_p$ 三个群的笛卡尔积。
- p 为 $2$ 时，乘法群 $\mathbb{Q}_2$ 同构于 $\mathbb{Z}$、$\frac{\mathbb{Z}}{2 \mathbb{Z}}$ 和 $\mathbb{Z}_2$ 三个群的笛卡尔积。

## p 进数中的平方元

在实数中的平方元是全体非负数，并且全体负数都是非平方元。在 p 进数中有类似的情形，靠近平方元的元素仍旧是平方元。

于是二次剩余的概念便体现在了 p 进数中。根据 p 进数的定义，即取 p 的幂次模后能区分的程度作为 p 进数右侧的数位，模 p 的幂中的平方元放在 p 进数中就变为了 p 进数中相应的平方元。

关于 p 进数平方元的充要条件，有定理：

$\mathbb{Q}_p$ 中的元素按照科学记数法写成 $p^n u$，$u$ 的小数点后均为 $0$，小数点前一位不为 $0$。从而平方元首先要求 $n$ 是偶数，并且有：

- p 为奇素数时，$u$ 小数点前一位是模 $p$ 的二次剩余。
- p 为 $2$ 时，$u$ 模 $8$ 余 $1$，即末三位为 $001$。

这与二次剩余部分的结论一致。

证明：$n$ 是偶数是显然的。

对于奇素数的情形，有关系：

$$
1+p \mathbb{Z}_p=\mathrm{e}^{p \mathbb{Z}_p}=\mathrm{e}^{2p \mathbb{Z}_p}={(\mathrm{e}^{p \mathbb{Z}_p})}^2
$$

因此 $1+p \mathbb{Z}_p$ 的元素在乘法群 $\mathbb{Z}_p$ 中为平方元。由于乘法群 $\frac{\mathbb{Z}_p}{1+p \mathbb{Z}_p}$ 与乘法群 $\frac{\mathbb{Z}}{p \mathbb{Z}}$ 同构，从而奇素数的情形得以证明。

对于 p 为 $2$ 的情形，有关系：

$$
1+8 \mathbb{Z}_2=\mathrm{e}^{8 \mathbb{Z}_2}=\mathrm{e}^{2\cdot 4 \mathbb{Z}_2}={(\mathrm{e}^{4 \mathbb{Z}_2})}^2
$$

因此 $1+8 \mathbb{Z}_2$ 的元素在乘法群 $\mathbb{Z}_2$ 中为平方元。由于乘法群 $\frac{\mathbb{Z}_p}{1+8 \mathbb{Z}_p}$ 与乘法群 $\frac{\mathbb{Z}}{8 \mathbb{Z}}$ 同构，即两个 $\frac{\mathbb{Z}}{2 \mathbb{Z}}$ 的笛卡尔积，从而 p 为 $2$ 的情形得以证明。证毕

这体现了 p 进数中的平方元具有某种聚集的特征，除了含 p 的个数为偶数条件以外，只与一位有效数字有关，对于 $2$ 进数是三位有效数字，与再左边全没关系。

注意，由于 $-1$ 完全有可能是模 $p$ 的二次剩余，从而试图引入虚数单位的常规办法对 $\mathbb{Q}_p$ 是不可行的。$\mathbb{Q}_p$ 的结构和 $\mathbb{R}$ 有着本质不同。

于是 p 进数平方乘法群是 p 进数乘法群的子群，最后可以得到二者商群的同构关系。有定理：

- p 为奇素数时，乘法群 $\frac{\mathbb{Q}_p}{{\mathbb{Q}_p}^2}$ 同构于两个 $\frac{\mathbb{Z}}{2 \mathbb{Z}}$ 的笛卡尔积。
- p 为 $2$ 时，乘法群 $\frac{\mathbb{Q}_2}{{\mathbb{Q}_2}^2}$ 同构于三个 $\frac{\mathbb{Z}}{2 \mathbb{Z}}$ 的笛卡尔积。

该定理不难证明。
